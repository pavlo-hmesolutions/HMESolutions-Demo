import React, { useEffect, useRef, useState } from 'react';
import { Container, Button, Modal, ModalHeader, ModalBody, ModalFooter, Input, Row, Col, Card, CardBody, ListGroup, ListGroupItem } from 'reactstrap';
import * as Leaflet from 'leaflet';
import 'leaflet/dist/leaflet.css'; // Ensure Leaflet's CSS is loaded
import 'leaflet-draw/dist/leaflet.draw.css';
import 'leaflet-draw';

import { ExtendedMarker } from './leaflet-extensions';
import { standbyTruck } from 'assets/images/map';

interface EquipmentLocation {
    id: string;
    name: string;
    color: string;
    status: string;
    position: Leaflet.LatLngExpression;
    vehicleType: string;
}

interface MarkerData {
    id: string;
    marker: ExtendedMarker;
}

interface Geofence {
    id: number,
    name: string;
    layer: Leaflet.Layer | null;  // Make layer nullable
}

const equipments: EquipmentLocation[] = [
    {
        id: "DT101",
        name: "DT101",
        status: "ACTIVE",
        color: "#009D10",
        vehicleType: "DUMP_TRUCK",
        position: [-29.160331938574046, 120.44974338024406]
    },
    {
        id: "DT102",
        name: "DT102",
        status: "ACTIVE",
        color: "#009D10",
        vehicleType: "DUMP_TRUCK",
        position: [-29.15837078907635, 120.44899479387436]
    },
    {
        id: "DT103",
        name: "DT103",
        status: "ACTIVE",
        color: "#009D10",
        vehicleType: "DUMP_TRUCK",
        position: [-29.156594353219155, 120.44783936708842]
    },
    {
        id: "DT104",
        name: "DT104",
        status: "ACTIVE",
        color: "#009D10",
        vehicleType: "DUMP_TRUCK",
        position: [-29.1576602184213, 120.44871814239025]
    },
    {
        id: "DT105",
        name: "DT105",
        status: "ACTIVE",
        color: "#009D10",
        vehicleType: "DUMP_TRUCK",
        position: [-29.156594353219155, 120.44783936708842]
    },
    {
        id: "DT106",
        name: "DT106",
        status: "STANDBY",
        color: "#F08B00",
        vehicleType: "DUMP_TRUCK",
        position: [-29.1540788674843, 120.44678158200134]
    },
    {
        id: "DT121",
        name: "DT121",
        status: "ACTIVE",
        color: "#009D10",
        vehicleType: "DUMP_TRUCK",
        position: [-29.15389411186601, 120.44697686540144]
    },
    {
        id: "DT122",
        name: "DT122",
        status: "ACTIVE",
        color: "#009D10",
        vehicleType: "DUMP_TRUCK",
        position: [-29.155798499987924, 120.44743252666956]
    },
    {
        id: "DT123",
        name: "DT123",
        status: "DELAY",
        color: "#BC00FF",
        vehicleType: "DUMP_TRUCK",
        position: [-29.155798499987924, 120.44743252666956]
    },
    {
        id: "EX201",
        name: "EX201",
        status: "ACTIVE",
        color: "#009D10",
        vehicleType: "EXCAVATOR",
        position: [
            -29.15837078907635,
            120.44899479387436
        ]
    },
    {
        id: "EX202",
        name: "EX202",
        status: "ACTIVE",
        color: "#009D10",
        vehicleType: "EXCAVATOR",
        position: [
            -29.159081354815896,
            120.44951554960937
        ]
    },
    {
        id: "EX205",
        name: "EX205",
        status: "DELAY",
        color: "#BC00FF",
        vehicleType: "EXCAVATOR",
        position: [
            -29.15456207291446,
            120.44756271560425

        ]
    }
]

const geojsons: any[] = [
    {
      "type": "Feature",
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [
              -29.146790943732764,
              120.44463458272295
            ],
            [
              -29.146790979250927,
              120.44463460034045
            ],
            [
              -29.14679448917799,
              120.44463638881909
            ],
            [
              -29.146822399430874,
              120.44464197334946
            ],
            [
              -29.146836242720088,
              120.44464474320831
            ],
            [
              -29.146839260961737,
              120.44464534772433
            ],
            [
              -29.14684319379653,
              120.44464613408866
            ],
            [
              -29.146845345410274,
              120.44464656481726
            ],
            [
              -29.146855913710652,
              120.44465087600283
            ],
            [
              -29.146870063288542,
              120.44465664917809
            ],
            [
              -29.146881665320127,
              120.44466138178016
            ],
            [
              -29.14688737678581,
              120.44466371176351
            ],
            [
              -29.14689957160986,
              120.44466868659178
            ],
            [
              -29.14691810160371,
              120.44467624622405
            ],
            [
              -29.146926735182873,
              120.44467976884468
            ],
            [
              -29.146927010644642,
              120.44467988019936
            ],
            [
              -29.14692712429492,
              120.44467992671062
            ],
            [
              -29.146927139760606,
              120.44467993352099
            ],
            [
              -29.146933675847205,
              120.44468259966911
            ],
            [
              -29.146943527879674,
              120.44468818742034
            ],
            [
              -29.14697270276353,
              120.44470473404455
            ],
            [
              -29.146989782149664,
              120.44471441976748
            ],
            [
              -29.14699554855566,
              120.44471769071538
            ],
            [
              -29.14701255498382,
              120.4447273350891
            ],
            [
              -29.14701577515822,
              120.44472916157692
            ],
            [
              -29.147018132861994,
              120.44473018116456
            ],
            [
              -29.14701829477147,
              120.44473025114371
            ],
            [
              -29.147023759666972,
              120.44473261292883
            ],
            [
              -29.14702603821936,
              120.44473359748241
            ],
            [
              -29.14706377492555,
              120.44474990644953
            ],
            [
              -29.147093276103693,
              120.44476265724869
            ],
            [
              -29.14710129969747,
              120.44476612407945
            ],
            [
              -29.147101703530655,
              120.44476615518506
            ],
            [
              -29.147104544789762,
              120.4447663725672
            ],
            [
              -29.147105157302107,
              120.44476641905818
            ],
            [
              -29.147109201024396,
              120.4447667289533
            ],
            [
              -29.147122622215047,
              120.44476775412178
            ],
            [
              -29.14715437202606,
              120.44477018237137
            ],
            [
              -29.14717963525913,
              120.44477211355654
            ],
            [
              -29.147190282051838,
              120.44477292688121
            ],
            [
              -29.147186196340698,
              120.44478663262058
            ],
            [
              -29.147177458635692,
              120.44481594789855
            ],
            [
              -29.147166954010217,
              120.4448511889791
            ],
            [
              -29.147162028937647,
              120.444867710603
            ],
            [
              -29.147156991994873,
              120.44488461007411
            ],
            [
              -29.147156581629055,
              120.44488598593253
            ],
            [
              -29.147156363734304,
              120.44488671682242
            ],
            [
              -29.147156137351917,
              120.44488747566801
            ],
            [
              -29.147144673817582,
              120.44488650272068
            ],
            [
              -29.147111432498406,
              120.44488367873804
            ],
            [
              -29.147082192169727,
              120.44488119448712
            ],
            [
              -29.14707210927747,
              120.44488033841651
            ],
            [
              -29.14706992787856,
              120.4448775428558
            ],
            [
              -29.14706611717818,
              120.44487266150463
            ],
            [
              -29.147066107222486,
              120.44487213972397
            ],
            [
              -29.147066068046385,
              120.44487008649654
            ],
            [
              -29.14706427731741,
              120.44487013083307
            ],
            [
              -29.147064196166525,
              120.44487013284227
            ],
            [
              -29.147064144771,
              120.44487013411477
            ],
            [
              -29.14706333565769,
              120.44486909776191
            ],
            [
              -29.147024803054812,
              120.44481972756823
            ],
            [
              -29.14702367766982,
              120.44481828491918
            ],
            [
              -29.147019881766713,
              120.44481342273063
            ],
            [
              -29.147003771488265,
              120.44479278125904
            ],
            [
              -29.14699899907302,
              120.4447866669566
            ],
            [
              -29.146995417467572,
              120.44478381666629
            ],
            [
              -29.146977447224053,
              120.44476951948798
            ],
            [
              -29.146976814268537,
              120.44476901621599
            ],
            [
              -29.146973884867077,
              120.44476668516403
            ],
            [
              -29.14693125475761,
              120.44473276798838
            ],
            [
              -29.14692808447142,
              120.44473024662904
            ],
            [
              -29.146927814243607,
              120.44473003135593
            ],
            [
              -29.14692204705745,
              120.44472544303116
            ],
            [
              -29.14691548317485,
              120.44472335303084
            ],
            [
              -29.146905486692727,
              120.4447201703806
            ],
            [
              -29.146904757884244,
              120.44471993871662
            ],
            [
              -29.146899672513875,
              120.44471831974836
            ],
            [
              -29.146882648354612,
              120.44471289930381
            ],
            [
              -29.146850031366835,
              120.44470251520463
            ],
            [
              -29.146837267564333,
              120.44469845156596
            ],
            [
              -29.14679827547618,
              120.44468603754379
            ],
            [
              -29.146791886773,
              120.44468400383934
            ],
            [
              -29.14679182740723,
              120.44468089267956
            ],
            [
              -29.14679175751664,
              120.44467722995395
            ],
            [
              -29.14679171435925,
              120.44467496822605
            ],
            [
              -29.14679164548766,
              120.44467135891095
            ],
            [
              -29.146791373979,
              120.44465713015693
            ],
            [
              -29.146791258813238,
              120.44465109477413
            ],
            [
              -29.146791134415885,
              120.4446445756158
            ],
            [
              -29.146790948613038,
              120.4446348384769
            ],
            [
              -29.146790946672684,
              120.44463473679158
            ],
            [
              -29.146790945300715,
              120.44463466489289
            ],
            [
              -29.146790943732764,
              120.44463458272295
            ]
          ]
        ]
      },
      "properties": {
        "altitude": 424.7,
        "source": "SWK_S01_420_004",
        "block_id": "HG01",
        "density": 2.37500524495468,
        "volume": 812.968118426174,
        "tonnes": 1930.8035452431,
        "grade": 2.07516757349061,
        "source_type": "DIGBLOCK",
        "fillColor": "#F8D904"
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [
              -29.146866690389505,
              120.444775600504
            ],
            [
              -29.146870893802152,
              120.44477732968622
            ],
            [
              -29.14688398049678,
              120.44478271404164
            ],
            [
              -29.146897423607673,
              120.44478824474285
            ],
            [
              -29.14690172612604,
              120.44479001463185
            ],
            [
              -29.146907643093847,
              120.44479228815413
            ],
            [
              -29.146929428012644,
              120.44480065918577
            ],
            [
              -29.146946514596788,
              120.44480722388784
            ],
            [
              -29.14695116929784,
              120.44480901280397
            ],
            [
              -29.146950190535595,
              120.4448127487696
            ],
            [
              -29.146947863926425,
              120.44482163252836
            ],
            [
              -29.14694445099802,
              120.44483466698712
            ],
            [
              -29.146943014804634,
              120.44484014888567
            ],
            [
              -29.146932746432913,
              120.44483614367283
            ],
            [
              -29.146930085257058,
              120.44483510487922
            ],
            [
              -29.146918241796367,
              120.44483048407695
            ],
            [
              -29.14689867388254,
              120.44482285043625
            ],
            [
              -29.146886789532545,
              120.44481821420713
            ],
            [
              -29.14688464188008,
              120.44481737644293
            ],
            [
              -29.146880478356852,
              120.44481575211515
            ],
            [
              -29.146866991651926,
              120.4448104896691
            ],
            [
              -29.1468574430906,
              120.4448067646466
            ],
            [
              -29.146858552576344,
              120.44480302442012
            ],
            [
              -29.146866690389505,
              120.444775600504
            ]
          ]
        ]
      },
      "properties": {
        "altitude": 424.7,
        "source": "SWK_S01_420_004",
        "block_id": "IG02",
        "density": 2.4,
        "volume": 78.6626008469378,
        "tonnes": 188.790242032651,
        "grade": 1.23313274627741,
        "source_type": "DIGBLOCK",
        "fillColor": "#8E8361"
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [
              -29.146697113123864,
              120.44458677415908
            ],
            [
              -29.14669984782636,
              120.44458816770391
            ],
            [
              -29.146718553450608,
              120.44459769802516
            ],
            [
              -29.146745395771276,
              120.44461137469025
            ],
            [
              -29.14675525145294,
              120.44461639715026
            ],
            [
              -29.14676364228484,
              120.4446206718164
            ],
            [
              -29.146784121561048,
              120.444631106715
            ],
            [
              -29.14678994257939,
              120.4446340721278
            ],
            [
              -29.146790943732764,
              120.44463458272295
            ],
            [
              -29.146790945300715,
              120.44463466489289
            ],
            [
              -29.146790946672684,
              120.44463473679158
            ],
            [
              -29.146790948613038,
              120.4446348384769
            ],
            [
              -29.146791134415885,
              120.4446445756158
            ],
            [
              -29.146791258813238,
              120.44465109477413
            ],
            [
              -29.146791373979,
              120.44465713015693
            ],
            [
              -29.14679164548766,
              120.44467135891095
            ],
            [
              -29.14679171435925,
              120.44467496822605
            ],
            [
              -29.14679175751664,
              120.44467722995395
            ],
            [
              -29.14679182740723,
              120.44468089267956
            ],
            [
              -29.146791886773,
              120.44468400383934
            ],
            [
              -29.146784698460152,
              120.44468171556206
            ],
            [
              -29.146783645616967,
              120.44468137991237
            ],
            [
              -29.14677112834514,
              120.44467685699833
            ],
            [
              -29.14675820412363,
              120.44467218693734
            ],
            [
              -29.146751581240206,
              120.4446697942315
            ],
            [
              -29.146746475307843,
              120.44466794867503
            ],
            [
              -29.146711891120212,
              120.44465545224816
            ],
            [
              -29.146706018528462,
              120.4446533297246
            ],
            [
              -29.1467010570404,
              120.44465153711155
            ],
            [
              -29.14667354537747,
              120.44464159592926
            ],
            [
              -29.146668508481795,
              120.44463977538372
            ],
            [
              -29.146669526166892,
              120.44463685027404
            ],
            [
              -29.146674381761525,
              120.4446228819938
            ],
            [
              -29.14667769210821,
              120.44461336041475
            ],
            [
              -29.146677920409978,
              120.44461270223034
            ],
            [
              -29.146679395222744,
              120.44461071017346
            ],
            [
              -29.14668031773783,
              120.44460946344925
            ],
            [
              -29.14668466741496,
              120.44460358777971
            ],
            [
              -29.146697113123864,
              120.44458677415908
            ]
          ]
        ]
      },
      "properties": {
        "altitude": 424.7,
        "source": "SWK_S01_420_004",
        "block_id": "IG01",
        "density": 2.4,
        "volume": 163.244136686903,
        "tonnes": 391.785928048568,
        "grade": 0.876597209403634,
        "source_type": "DIGBLOCK",
        "fillColor": "#948F82"
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [
              -29.146959883323504,
              120.4448974100388
            ],
            [
              -29.146967408482944,
              120.44490099403346
            ],
            [
              -29.146968857434675,
              120.4449016651563
            ],
            [
              -29.146976528156028,
              120.44490521882975
            ],
            [
              -29.14697977737928,
              120.44490672398867
            ],
            [
              -29.147014362083745,
              120.44492274727816
            ],
            [
              -29.147016877735865,
              120.44492391299111
            ],
            [
              -29.147022035529314,
              120.44492630191463
            ],
            [
              -29.147043142767345,
              120.44493608114772
            ],
            [
              -29.147046743310117,
              120.44493774922165
            ],
            [
              -29.14705343563564,
              120.44494085031126
            ],
            [
              -29.14705743656404,
              120.44494199055598
            ],
            [
              -29.147063006642306,
              120.44494357698457
            ],
            [
              -29.147067494651658,
              120.44494485622928
            ],
            [
              -29.147081946425484,
              120.44494897471023
            ],
            [
              -29.14711284634032,
              120.44495777984422
            ],
            [
              -29.147130107184566,
              120.44496269814182
            ],
            [
              -29.147133433267868,
              120.4449636454628
            ],
            [
              -29.14713310005443,
              120.44496476250717
            ],
            [
              -29.14713116857683,
              120.4449712359921
            ],
            [
              -29.14712262955421,
              120.44499985576563
            ],
            [
              -29.14712116281776,
              120.44500477735136
            ],
            [
              -29.147113870388072,
              120.44500180723333
            ],
            [
              -29.147113684897946,
              120.4450017306442
            ],
            [
              -29.14711196113153,
              120.44500102932885
            ],
            [
              -29.147107609846415,
              120.44499925652488
            ],
            [
              -29.147068226487225,
              120.44498321327374
            ],
            [
              -29.147055101751842,
              120.44497786784808
            ],
            [
              -29.147048436632407,
              120.44497515246469
            ],
            [
              -29.147044260820735,
              120.44497345136169
            ],
            [
              -29.147044045163543,
              120.44497340120984
            ],
            [
              -29.14704401525144,
              120.4449733937295
            ],
            [
              -29.14703323107822,
              120.44497086458998
            ],
            [
              -29.147022839251303,
              120.44496842644321
            ],
            [
              -29.14700076253627,
              120.4449632481906
            ],
            [
              -29.146977531382717,
              120.44495779948643
            ],
            [
              -29.146956498552555,
              120.44495286565493
            ],
            [
              -29.146952347455226,
              120.44495189251866
            ],
            [
              -29.14694635331337,
              120.44495063309411
            ],
            [
              -29.14693223292025,
              120.44494766555795
            ],
            [
              -29.14693207955246,
              120.44493962726983
            ],
            [
              -29.1469319695922,
              120.44493386406587
            ],
            [
              -29.14693182729609,
              120.44492640610406
            ],
            [
              -29.14693179648906,
              120.44492479146201
            ],
            [
              -29.14693160551244,
              120.44491478211934
            ],
            [
              -29.146931558772533,
              120.44491233242391
            ],
            [
              -29.14693155007126,
              120.44491187637998
            ],
            [
              -29.1469315212434,
              120.44491036547768
            ],
            [
              -29.146931192925923,
              120.44489315803644
            ],
            [
              -29.146931181598504,
              120.44489256435764
            ],
            [
              -29.14693109968045,
              120.44488827097118
            ],
            [
              -29.146931096975987,
              120.44488812922779
            ],
            [
              -29.14693102205415,
              120.44488420252529
            ],
            [
              -29.146931011686988,
              120.44488365917567
            ],
            [
              -29.146947551376567,
              120.44489153633286
            ],
            [
              -29.146959883323504,
              120.4448974100388
            ]
          ]
        ]
      },
      "properties": {
        "altitude": 424.7,
        "source": "SWK_S01_420_004",
        "block_id": "IG03",
        "density": 2.4,
        "volume": 241.871852784097,
        "tonnes": 580.492446681833,
        "grade": 1.15845148948676,
        "source_type": "DIGBLOCK",
        "fillColor": "#8A7A47"
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [
              -29.146653124611298,
              120.444806173616
            ],
            [
              -29.14665894137593,
              120.44480820710024
            ],
            [
              -29.146671724638832,
              120.44481267617097
            ],
            [
              -29.146704349339302,
              120.44482407948911
            ],
            [
              -29.14671024692127,
              120.44482614077488
            ],
            [
              -29.146713919522078,
              120.44482742478581
            ],
            [
              -29.14673298724381,
              120.44483409046158
            ],
            [
              -29.146742166903124,
              120.44483729848073
            ],
            [
              -29.146746878426203,
              120.44483984333665
            ],
            [
              -29.14674971317283,
              120.44484137416681
            ],
            [
              -29.146749785169572,
              120.44484141246102
            ],
            [
              -29.146750083231755,
              120.44484157360927
            ],
            [
              -29.146761858824576,
              120.44484793274714
            ],
            [
              -29.146781428588103,
              120.4448585001644
            ],
            [
              -29.146783590572227,
              120.44485852884516
            ],
            [
              -29.146793375483103,
              120.44485866063297
            ],
            [
              -29.146795219841998,
              120.44485868484641
            ],
            [
              -29.146801251937642,
              120.44485876568385
            ],
            [
              -29.146840336500343,
              120.44485929008775
            ],
            [
              -29.14687274289673,
              120.444859724987
            ],
            [
              -29.14688098750948,
              120.44485983530892
            ],
            [
              -29.14688158745628,
              120.44486012154486
            ],
            [
              -29.146885492961598,
              120.44486198141989
            ],
            [
              -29.146891091752885,
              120.44486464715017
            ],
            [
              -29.14689126656014,
              120.44486473119669
            ],
            [
              -29.14689135849174,
              120.44486477413544
            ],
            [
              -29.146910594718214,
              120.44487393583256
            ],
            [
              -29.146921744982087,
              120.44487924585992
            ],
            [
              -29.146931011686988,
              120.44488365917567
            ],
            [
              -29.14693102205415,
              120.44488420252529
            ],
            [
              -29.146931096975987,
              120.44488812922779
            ],
            [
              -29.14693109968045,
              120.44488827097118
            ],
            [
              -29.146931181598504,
              120.44489256435764
            ],
            [
              -29.146931192925923,
              120.44489315803644
            ],
            [
              -29.1469315212434,
              120.44491036547768
            ],
            [
              -29.14693155007126,
              120.44491187637998
            ],
            [
              -29.146931558772533,
              120.44491233242391
            ],
            [
              -29.14693160551244,
              120.44491478211934
            ],
            [
              -29.14693179648906,
              120.44492479146201
            ],
            [
              -29.14693182729609,
              120.44492640610406
            ],
            [
              -29.1469319695922,
              120.44493386406587
            ],
            [
              -29.14693207955246,
              120.44493962726983
            ],
            [
              -29.14693223292025,
              120.44494766555795
            ],
            [
              -29.146911391085983,
              120.44494328602165
            ],
            [
              -29.146886946235202,
              120.44493814893927
            ],
            [
              -29.146874533144633,
              120.44493553990446
            ],
            [
              -29.146863921581833,
              120.4449333106709
            ],
            [
              -29.14685670762072,
              120.44493393320253
            ],
            [
              -29.14684178528567,
              120.44493522236203
            ],
            [
              -29.146816181611783,
              120.44493743364023
            ],
            [
              -29.14680380441545,
              120.44493850256143
            ],
            [
              -29.146798784302373,
              120.44493656854674
            ],
            [
              -29.14679669047651,
              120.44493576233147
            ],
            [
              -29.14679121686025,
              120.44493365251991
            ],
            [
              -29.14677809494506,
              120.44492859682832
            ],
            [
              -29.14676512206088,
              120.44492359807711
            ],
            [
              -29.14676197494169,
              120.44492238531627
            ],
            [
              -29.14675551524073,
              120.44492112200713
            ],
            [
              -29.146751290263975,
              120.44492029559544
            ],
            [
              -29.14673338706656,
              120.44491679282523
            ],
            [
              -29.146706016178726,
              120.44491143943985
            ],
            [
              -29.14669373965168,
              120.44490903768988
            ],
            [
              -29.14669336478992,
              120.44490896476206
            ],
            [
              -29.146693182339135,
              120.44490862194745
            ],
            [
              -29.146689569880216,
              120.44490183771032
            ],
            [
              -29.14667779723523,
              120.44487969956646
            ],
            [
              -29.146668886819544,
              120.44486294408131
            ],
            [
              -29.146665877712735,
              120.4448572865823
            ],
            [
              -29.146665218065497,
              120.44485538436922
            ],
            [
              -29.146660381331408,
              120.44484136011766
            ],
            [
              -29.14666007388274,
              120.44484047062755
            ],
            [
              -29.146659503876897,
              120.44483768759008
            ],
            [
              -29.146659496429717,
              120.44483729728327
            ],
            [
              -29.146659482515236,
              120.44483656802579
            ],
            [
              -29.14665933384558,
              120.44482877626918
            ],
            [
              -29.14665770722163,
              120.4448288165426
            ],
            [
              -29.14665731178491,
              120.44482686154592
            ],
            [
              -29.146654397501273,
              120.44481246291942
            ],
            [
              -29.146653124611298,
              120.444806173616
            ]
          ]
        ]
      },
      "properties": {
        "altitude": 424.7,
        "source": "SWK_S01_420_004",
        "block_id": "LG01",
        "density": 2.4,
        "volume": 536.769662203038,
        "tonnes": 1288.24718928729,
        "grade": 1.29086820640294,
        "source_type": "DIGBLOCK",
        "fillColor": "#856600"
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [
              -29.147133433267868,
              120.4449636454628
            ],
            [
              -29.14713620776002,
              120.44496471331193
            ],
            [
              -29.14715184040732,
              120.44497072419861
            ],
            [
              -29.14715290275648,
              120.44497113257741
            ],
            [
              -29.14715824541405,
              120.44497318706517
            ],
            [
              -29.1471838445453,
              120.4449830308307
            ],
            [
              -29.147203683896166,
              120.44499065985416
            ],
            [
              -29.147203755150876,
              120.44499439449426
            ],
            [
              -29.14720379020987,
              120.44499623202759
            ],
            [
              -29.1472038706162,
              120.44500044633685
            ],
            [
              -29.147204061176513,
              120.44501043413686
            ],
            [
              -29.14720409578456,
              120.44501224804625
            ],
            [
              -29.147204259084866,
              120.44502080711027
            ],
            [
              -29.14720433453244,
              120.44502476155607
            ],
            [
              -29.147204340901386,
              120.44502509537291
            ],
            [
              -29.147199723168086,
              120.44502396731146
            ],
            [
              -29.147188392286797,
              120.44502119993389
            ],
            [
              -29.14716305776292,
              120.44501501202194
            ],
            [
              -29.147159024609103,
              120.44501402671334
            ],
            [
              -29.14715383680142,
              120.44501275965202
            ],
            [
              -29.147129058748067,
              120.44500670697057
            ],
            [
              -29.14712117101124,
              120.44500478125896
            ],
            [
              -29.14712264288338,
              120.44499984515949
            ],
            [
              -29.14713117038018,
              120.44497123594743
            ],
            [
              -29.14713310089732,
              120.44496475940346
            ],
            [
              -29.147133433267868,
              120.4449636454628
            ]
          ]
        ]
      },
      "properties": {
        "altitude": 424.7,
        "source": "SWK_S01_420_003",
        "block_id": "HG02",
        "density": 2.4,
        "volume": 81.8990203427433,
        "tonnes": 196.557648822584,
        "grade": 2.22237212308247,
        "source_type": "DIGBLOCK",
        "fillColor": "#D7B300"
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [
              -29.147216035897568,
              120.44499540990572
            ],
            [
              -29.147222671732667,
              120.44499796160076
            ],
            [
              -29.14722809277396,
              120.44500067285111
            ],
            [
              -29.147249181304563,
              120.44501122123465
            ],
            [
              -29.147262021692477,
              120.44501764448684
            ],
            [
              -29.14726532240767,
              120.4450192953269
            ],
            [
              -29.14726752378613,
              120.44502039586467
            ],
            [
              -29.147267844390065,
              120.44502055645604
            ],
            [
              -29.14727420003843,
              120.44502317469217
            ],
            [
              -29.14729467537918,
              120.44503160801987
            ],
            [
              -29.14731461973132,
              120.44503982328324
            ],
            [
              -29.147320810784628,
              120.4450423726358
            ],
            [
              -29.147319927324077,
              120.44504524100192
            ],
            [
              -29.14731345004884,
              120.44506627222447
            ],
            [
              -29.147310209426728,
              120.44506583248018
            ],
            [
              -29.147295289694547,
              120.44506380648158
            ],
            [
              -29.147264647091955,
              120.4450596459173
            ],
            [
              -29.147258013895744,
              120.44505874552854
            ],
            [
              -29.14725678015202,
              120.4450579118489
            ],
            [
              -29.147252316752134,
              120.44505489634746
            ],
            [
              -29.147249984515618,
              120.44505332018045
            ],
            [
              -29.147238485124326,
              120.4450455504337
            ],
            [
              -29.147210399687996,
              120.44502657516796
            ],
            [
              -29.14720948521297,
              120.44502635220839
            ],
            [
              -29.147204340901386,
              120.44502509537291
            ],
            [
              -29.14720433453244,
              120.44502476155607
            ],
            [
              -29.147204259084866,
              120.44502080711027
            ],
            [
              -29.14720409578456,
              120.44501224804625
            ],
            [
              -29.147204061176513,
              120.44501043413686
            ],
            [
              -29.1472038706162,
              120.44500044633685
            ],
            [
              -29.14720379020987,
              120.44499623202759
            ],
            [
              -29.147203755150876,
              120.44499439449426
            ],
            [
              -29.147203683896166,
              120.44499065985416
            ],
            [
              -29.147211962798103,
              120.444993843957
            ],
            [
              -29.147216035897568,
              120.44499540990572
            ]
          ]
        ]
      },
      "properties": {
        "altitude": 424.7,
        "source": "SWK_S01_420_003",
        "block_id": "LG01",
        "density": 2.4,
        "volume": 110.100465572966,
        "tonnes": 264.241117375119,
        "grade": 0.845524057506674,
        "source_type": "DIGBLOCK",
        "fillColor": "#856600"
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [
              -29.147190282051838,
              120.44477292688121
            ],
            [
              -29.147191702581544,
              120.44477366858489
            ],
            [
              -29.1471996225197,
              120.44477780182422
            ],
            [
              -29.147229232967245,
              120.44479325359245
            ],
            [
              -29.147234525993472,
              120.44479601629945
            ],
            [
              -29.147236239254667,
              120.44479659250314
            ],
            [
              -29.14724514331642,
              120.44479958744527
            ],
            [
              -29.147270959373515,
              120.44480827076377
            ],
            [
              -29.147270972094987,
              120.44480827558684
            ],
            [
              -29.147275942089134,
              120.44480994674616
            ],
            [
              -29.147276756732385,
              120.44481042188607
            ],
            [
              -29.14728180781458,
              120.44481336425238
            ],
            [
              -29.14728340971761,
              120.44481429774082
            ],
            [
              -29.14729060913705,
              120.4448184919861
            ],
            [
              -29.14731379835996,
              120.44483200231932
            ],
            [
              -29.147318943392325,
              120.4448349988803
            ],
            [
              -29.14732541210283,
              120.44483857820939
            ],
            [
              -29.14733621149673,
              120.44484455255648
            ],
            [
              -29.147356578557492,
              120.44485582064107
            ],
            [
              -29.147368814847322,
              120.44486259075597
            ],
            [
              -29.147372459924785,
              120.44486460711828
            ],
            [
              -29.147373005143745,
              120.44486490909703
            ],
            [
              -29.147374357852843,
              120.44486521677331
            ],
            [
              -29.14738174298589,
              120.4448668990451
            ],
            [
              -29.147407173681557,
              120.44487268994342
            ],
            [
              -29.147411833441918,
              120.44487375119154
            ],
            [
              -29.147414769790327,
              120.44487346782851
            ],
            [
              -29.147426950987718,
              120.44487229172996
            ],
            [
              -29.147446640954065,
              120.44487038919301
            ],
            [
              -29.147451388103867,
              120.44486993151587
            ],
            [
              -29.14745551716679,
              120.44487164097079
            ],
            [
              -29.147461432075044,
              120.44487409028093
            ],
            [
              -29.147472175294915,
              120.44487853899122
            ],
            [
              -29.147488570623782,
              120.44488532739967
            ],
            [
              -29.147497598916793,
              120.44488906532914
            ],
            [
              -29.14750390027084,
              120.44489167462982
            ],
            [
              -29.147505988101276,
              120.44489183565358
            ],
            [
              -29.14751153152599,
              120.44489226153716
            ],
            [
              -29.147517551055152,
              120.4448927239308
            ],
            [
              -29.14753746891782,
              120.44489425518697
            ],
            [
              -29.147562722408072,
              120.4448961958921
            ],
            [
              -29.147566878173233,
              120.44489651534961
            ],
            [
              -29.14756749703649,
              120.44489656373933
            ],
            [
              -29.147574896766667,
              120.44489986209652
            ],
            [
              -29.14759403530078,
              120.44490839531237
            ],
            [
              -29.14760062983532,
              120.44491133544363
            ],
            [
              -29.147608180615343,
              120.44491470199615
            ],
            [
              -29.14761938895991,
              120.44491969925167
            ],
            [
              -29.1476253529689,
              120.44492235801381
            ],
            [
              -29.147629157937665,
              120.44492405494506
            ],
            [
              -29.147638188175538,
              120.44493162996042
            ],
            [
              -29.147653859510363,
              120.44494477466182
            ],
            [
              -29.147663791851606,
              120.44495310628061
            ],
            [
              -29.147669515280448,
              120.44495790742107
            ],
            [
              -29.147696773758142,
              120.44498077322896
            ],
            [
              -29.14769969827566,
              120.4449832267095
            ],
            [
              -29.147703480872153,
              120.4449863988311
            ],
            [
              -29.14770463142645,
              120.4449873640527
            ],
            [
              -29.14771331474874,
              120.44499089371088
            ],
            [
              -29.14771708590467,
              120.4449924260364
            ],
            [
              -29.147745196883474,
              120.44500385082324
            ],
            [
              -29.147750924535856,
              120.44500617838563
            ],
            [
              -29.14775346198527,
              120.44500720997739
            ],
            [
              -29.147785603232666,
              120.44502027269434
            ],
            [
              -29.147790654491757,
              120.44502232618825
            ],
            [
              -29.147792196414,
              120.44502295288306
            ],
            [
              -29.14779661397228,
              120.44502474769197
            ],
            [
              -29.147803311691487,
              120.44502690223453
            ],
            [
              -29.147836047819965,
              120.44503743256509
            ],
            [
              -29.147849838093652,
              120.44504186855151
            ],
            [
              -29.147852662786068,
              120.44504277793992
            ],
            [
              -29.147851941296967,
              120.44504519940672
            ],
            [
              -29.14784865167707,
              120.44505623425687
            ],
            [
              -29.14784212504605,
              120.44507813001249
            ],
            [
              -29.147840687966696,
              120.44508295121905
            ],
            [
              -29.147839863265595,
              120.44508308364733
            ],
            [
              -29.147836927797773,
              120.44508355503925
            ],
            [
              -29.147813039378494,
              120.44508739271129
            ],
            [
              -29.147791960525286,
              120.44509077957626
            ],
            [
              -29.14778529546696,
              120.44509184991952
            ],
            [
              -29.147779983923645,
              120.44509270280908
            ],
            [
              -29.147777741864846,
              120.44509306351985
            ],
            [
              -29.147771613510592,
              120.44509195640836
            ],
            [
              -29.14774679230855,
              120.44508747187106
            ],
            [
              -29.147723063721337,
              120.44508318533363
            ],
            [
              -29.14770153118403,
              120.44507929452602
            ],
            [
              -29.147690769002285,
              120.44507735056294
            ],
            [
              -29.147688595552978,
              120.44507695735804
            ],
            [
              -29.147678908775923,
              120.44507520770898
            ],
            [
              -29.147674013006732,
              120.44509128064061
            ],
            [
              -29.147673344853732,
              120.44509347162338
            ],
            [
              -29.14768384342744,
              120.44510027555764
            ],
            [
              -29.147700817955055,
              120.44511127524297
            ],
            [
              -29.147701341337147,
              120.44511161475877
            ],
            [
              -29.147702157900245,
              120.44511214329147
            ],
            [
              -29.147737945641115,
              120.4451353354339
            ],
            [
              -29.147738790528436,
              120.44513588279047
            ],
            [
              -29.14774782764515,
              120.44514173845478
            ],
            [
              -29.147758634020633,
              120.4451487413297
            ],
            [
              -29.147760831652725,
              120.44515016566764
            ],
            [
              -29.147770364667302,
              120.44515312350148
            ],
            [
              -29.14777065867206,
              120.44515321384671
            ],
            [
              -29.14779328559088,
              120.44516023237091
            ],
            [
              -29.14779328637472,
              120.4451602734563
            ],
            [
              -29.147793288157967,
              120.44516036692553
            ],
            [
              -29.147793564972595,
              120.44516036007249
            ],
            [
              -29.147793685797232,
              120.44516035708126
            ],
            [
              -29.14780903841609,
              120.44516511920943
            ],
            [
              -29.147815590376357,
              120.4451671520003
            ],
            [
              -29.147814298270166,
              120.44517148663402
            ],
            [
              -29.14780479062067,
              120.44520338298489
            ],
            [
              -29.14779687787173,
              120.44520525286917
            ],
            [
              -29.147794156765958,
              120.44520589570112
            ],
            [
              -29.147787103452792,
              120.44520756241974
            ],
            [
              -29.14776659099588,
              120.44521240884367
            ],
            [
              -29.147757014142073,
              120.44521467136929
            ],
            [
              -29.14774925407035,
              120.44521650561563
            ],
            [
              -29.147744598552602,
              120.44521760532818
            ],
            [
              -29.147741202109877,
              120.44521840771728
            ],
            [
              -29.14773885278915,
              120.44521896221772
            ],
            [
              -29.14773707257119,
              120.44521818624894
            ],
            [
              -29.147726119251868,
              120.44521341077365
            ],
            [
              -29.147721762853436,
              120.44521151168146
            ],
            [
              -29.147703905122437,
              120.44520372459911
            ],
            [
              -29.14765961058421,
              120.44518441060822
            ],
            [
              -29.14765842164862,
              120.44518389232138
            ],
            [
              -29.147652561571274,
              120.44518133784246
            ],
            [
              -29.147648798258373,
              120.44517969638895
            ],
            [
              -29.147636058193957,
              120.44517389745934
            ],
            [
              -29.147615973505033,
              120.4451647566564
            ],
            [
              -29.147614479274488,
              120.44516407637107
            ],
            [
              -29.147612924984628,
              120.44516336879931
            ],
            [
              -29.147607003593755,
              120.44516067402914
            ],
            [
              -29.14760438915092,
              120.44515948403239
            ],
            [
              -29.147601310600812,
              120.44515808253237
            ],
            [
              -29.147579534319586,
              120.4451174429423
            ],
            [
              -29.147577860864068,
              120.44511431930958
            ],
            [
              -29.14757776544414,
              120.44511414081117
            ],
            [
              -29.147576560640015,
              120.44511189241015
            ],
            [
              -29.147574780767233,
              120.44510872311416
            ],
            [
              -29.14756734094801,
              120.44509547428537
            ],
            [
              -29.147566495830226,
              120.44509396919602
            ],
            [
              -29.147565066117895,
              120.44509142218881
            ],
            [
              -29.147549466473315,
              120.44506364140018
            ],
            [
              -29.147539750897373,
              120.44504633947881
            ],
            [
              -29.147534736247668,
              120.44503741032197
            ],
            [
              -29.147529508746764,
              120.44503614321145
            ],
            [
              -29.147520244602983,
              120.44503389704143
            ],
            [
              -29.147519901123562,
              120.44503381408728
            ],
            [
              -29.147474929859186,
              120.44502290949846
            ],
            [
              -29.147446791223278,
              120.4450160870812
            ],
            [
              -29.147441983334407,
              120.44501492159398
            ],
            [
              -29.14744002121082,
              120.44501444608773
            ],
            [
              -29.147429615134396,
              120.44501192299082
            ],
            [
              -29.1474160497057,
              120.44500863341295
            ],
            [
              -29.147411112210794,
              120.44500743619615
            ],
            [
              -29.14740686847857,
              120.44500595770599
            ],
            [
              -29.147384245772415,
              120.44499807285132
            ],
            [
              -29.147373703155758,
              120.44499439809752
            ],
            [
              -29.147353485196216,
              120.44498735081876
            ],
            [
              -29.14733883870455,
              120.44498224652428
            ],
            [
              -29.1473077266703,
              120.44497140166688
            ],
            [
              -29.147297876068965,
              120.44496796874384
            ],
            [
              -29.147295572113396,
              120.44496716567203
            ],
            [
              -29.147295311470565,
              120.44496707450168
            ],
            [
              -29.147293431615783,
              120.44496641918259
            ],
            [
              -29.147287752103296,
              120.44496443982791
            ],
            [
              -29.147282486694753,
              120.44496260436317
            ],
            [
              -29.147277264628674,
              120.44496001458397
            ],
            [
              -29.14727557432263,
              120.44495917576728
            ],
            [
              -29.147247926656462,
              120.44494546237044
            ],
            [
              -29.147240668197888,
              120.4449418614851
            ],
            [
              -29.14723885222582,
              120.44494096104056
            ],
            [
              -29.147235017337575,
              120.44493637212067
            ],
            [
              -29.147219387934864,
              120.44491767114921
            ],
            [
              -29.1472092856027,
              120.44490558373587
            ],
            [
              -29.147206798556176,
              120.44490260768521
            ],
            [
              -29.147206081861672,
              120.44490239627176
            ],
            [
              -29.147201976750495,
              120.44490118564623
            ],
            [
              -29.147162850734205,
              120.44488964727309
            ],
            [
              -29.147162170322304,
              120.44488944626521
            ],
            [
              -29.147156616395524,
              120.44488780805796
            ],
            [
              -29.147156297966976,
              120.44488771420814
            ],
            [
              -29.14715608477962,
              120.44488765166392
            ],
            [
              -29.147156338310623,
              120.44488680274381
            ],
            [
              -29.147156581629055,
              120.44488598593253
            ],
            [
              -29.147156948753068,
              120.44488475501062
            ],
            [
              -29.147162028937647,
              120.444867710603
            ],
            [
              -29.14716696673184,
              120.44485114653199
            ],
            [
              -29.147177458635692,
              120.44481594789855
            ],
            [
              -29.14718617858143,
              120.44478669471712
            ],
            [
              -29.147190282051838,
              120.44477292688121
            ]
          ]
        ]
      },
      "properties": {
        "altitude": 424.7,
        "source": "SWK_S01_420_003",
        "block_id": "HG01",
        "density": 2.35470442336042,
        "volume": 2800.60849997789,
        "tonnes": 6594.60522299874,
        "grade": 3.12413519082329,
        "source_type": "DIGBLOCK",
        "fillColor": "#F8D904"
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [
              -29.147815590376357,
              120.4451671520003
            ],
            [
              -29.147819456759027,
              120.44516804896209
            ],
            [
              -29.14783862466552,
              120.44517249569977
            ],
            [
              -29.147846270458377,
              120.4451742701972
            ],
            [
              -29.147847812655954,
              120.44517462765126
            ],
            [
              -29.147860762685866,
              120.44517474070626
            ],
            [
              -29.147870644135356,
              120.44517482593966
            ],
            [
              -29.14788377642142,
              120.44517494064814
            ],
            [
              -29.147900249731272,
              120.4451750836265
            ],
            [
              -29.14792888900465,
              120.44517533235204
            ],
            [
              -29.147942411951625,
              120.44517544971997
            ],
            [
              -29.14795143808276,
              120.44517552838208
            ],
            [
              -29.1479557246904,
              120.44517556612615
            ],
            [
              -29.14795930740289,
              120.44517554319724
            ],
            [
              -29.147963415086952,
              120.44517551754784
            ],
            [
              -29.147973996355475,
              120.4451754498092
            ],
            [
              -29.14799068322653,
              120.44517534395314
            ],
            [
              -29.147997160437278,
              120.4451753028016
            ],
            [
              -29.14800281051692,
              120.44517526671294
            ],
            [
              -29.14800247446428,
              120.44517921390758
            ],
            [
              -29.14800014140134,
              120.44520662696343
            ],
            [
              -29.14800002793941,
              120.44520796157042
            ],
            [
              -29.148000011747353,
              120.44520815310898
            ],
            [
              -29.147996078339627,
              120.44520851869602
            ],
            [
              -29.147974665223632,
              120.44521050906172
            ],
            [
              -29.14796007703561,
              120.44521186495231
            ],
            [
              -29.14792963995852,
              120.44521469426252
            ],
            [
              -29.14790165495178,
              120.44521729536366
            ],
            [
              -29.147888242824294,
              120.4452185419821
            ],
            [
              -29.147887768131838,
              120.44521839034203
            ],
            [
              -29.14788458600471,
              120.44521737573143
            ],
            [
              -29.147881173323313,
              120.44521628667411
            ],
            [
              -29.14786164301304,
              120.44521005570091
            ],
            [
              -29.14784556803716,
              120.44520492711712
            ],
            [
              -29.147839749237082,
              120.44520307039316
            ],
            [
              -29.147839265801377,
              120.44520307516798
            ],
            [
              -29.1478392080745,
              120.44520307556947
            ],
            [
              -29.147835554266635,
              120.44520310745048
            ],
            [
              -29.14780479062067,
              120.44520338298489
            ],
            [
              -29.147814293996934,
              120.44517149907126
            ],
            [
              -29.147815590376357,
              120.4451671520003
            ]
          ]
        ]
      },
      "properties": {
        "altitude": 424.7,
        "source": "SWK_S01_420_002",
        "block_id": "HG02",
        "density": 2.4,
        "volume": 190.148417752949,
        "tonnes": 456.356202607077,
        "grade": 1.46635548387291,
        "source_type": "DIGBLOCK",
        "fillColor": "#D7B300"
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [
              -29.148070662725775,
              120.4451534999591
            ],
            [
              -29.148092302054962,
              120.44515296422983
            ],
            [
              -29.14810238192487,
              120.44516184202742
            ],
            [
              -29.14810729982029,
              120.44516617296489
            ],
            [
              -29.14810916604605,
              120.4451678161748
            ],
            [
              -29.148111310280772,
              120.44516970426973
            ],
            [
              -29.148116957628577,
              120.44517467893816
            ],
            [
              -29.148123058203574,
              120.44518005138058
            ],
            [
              -29.148128530273873,
              120.44518487008023
            ],
            [
              -29.14813171823239,
              120.44518775071113
            ],
            [
              -29.148148546504075,
              120.44520295294342
            ],
            [
              -29.148149703094013,
              120.44520399817648
            ],
            [
              -29.148155053652836,
              120.44520883119064
            ],
            [
              -29.148200358649085,
              120.44524975995829
            ],
            [
              -29.148200949792727,
              120.44525029407491
            ],
            [
              -29.14820097366741,
              120.4452503160916
            ],
            [
              -29.148203904589597,
              120.44525296365333
            ],
            [
              -29.14820419739758,
              120.44525322769721
            ],
            [
              -29.1482101262595,
              120.4452585838471
            ],
            [
              -29.148228666630555,
              120.44527061357341
            ],
            [
              -29.14824666535029,
              120.44528229190635
            ],
            [
              -29.148252218889407,
              120.44528589600311
            ],
            [
              -29.148255920020418,
              120.44528829739473
            ],
            [
              -29.14825795874148,
              120.44528961983043
            ],
            [
              -29.148256863618396,
              120.44529250579289
            ],
            [
              -29.14825282829675,
              120.44530313370468
            ],
            [
              -29.148247650570585,
              120.4453167700078
            ],
            [
              -29.14824733878142,
              120.44531759160498
            ],
            [
              -29.14824642397641,
              120.4453199993681
            ],
            [
              -29.148246245343497,
              120.44532047135941
            ],
            [
              -29.14820306937668,
              120.44530867333107
            ],
            [
              -29.148202058266136,
              120.44530839726811
            ],
            [
              -29.148199040341343,
              120.44530757280832
            ],
            [
              -29.14819718224462,
              120.4453070649177
            ],
            [
              -29.148195292463058,
              120.44530480160216
            ],
            [
              -29.148195093056884,
              120.44530456299177
            ],
            [
              -29.148187887580704,
              120.44529593668804
            ],
            [
              -29.14815598682155,
              120.44525774454857
            ],
            [
              -29.148155938048195,
              120.44525518800101
            ],
            [
              -29.148155922587282,
              120.44525437758881
            ],
            [
              -29.148155918276256,
              120.44525415161834
            ],
            [
              -29.148153690234,
              120.44525420677644
            ],
            [
              -29.148153044633734,
              120.4452542227591
            ],
            [
              -29.148126738393696,
              120.44522272892115
            ],
            [
              -29.14811972030344,
              120.44521432612208
            ],
            [
              -29.14811697992645,
              120.44521202015521
            ],
            [
              -29.1481098956664,
              120.44520605960055
            ],
            [
              -29.148109866096135,
              120.44520450964944
            ],
            [
              -29.148109854671716,
              120.44520391082801
            ],
            [
              -29.148108058532486,
              120.44520395529456
            ],
            [
              -29.148107413833916,
              120.4452039712552
            ],
            [
              -29.148064226055542,
              120.44516762881435
            ],
            [
              -29.14806405462022,
              120.44516748508093
            ],
            [
              -29.148060010522617,
              120.44516408203559
            ],
            [
              -29.148051895747493,
              120.44515725399602
            ],
            [
              -29.148048290195256,
              120.44515428299958
            ],
            [
              -29.14804801983079,
              120.44515406053324
            ],
            [
              -29.148048890850095,
              120.44515403896929
            ],
            [
              -29.14805992285949,
              120.44515376584796
            ],
            [
              -29.148060345745684,
              120.44515375537848
            ],
            [
              -29.148063791050784,
              120.44515367008245
            ],
            [
              -29.148070195657446,
              120.4451535115224
            ],
            [
              -29.148070662725775,
              120.4451534999591
            ]
          ]
        ]
      },
      "properties": {
        "altitude": 424.7,
        "source": "SWK_S01_420_002",
        "block_id": "HG03",
        "density": 2.4,
        "volume": 222.233822356864,
        "tonnes": 533.361173656473,
        "grade": 1.15665929264862,
        "source_type": "DIGBLOCK",
        "fillColor": "#B08C00"
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [
              -29.14799975546816,
              120.44502913538324
            ],
            [
              -29.14800406899666,
              120.44503181344292
            ],
            [
              -29.14800898870465,
              120.44503486801881
            ],
            [
              -29.14801650840819,
              120.44503953735808
            ],
            [
              -29.148025227670754,
              120.44504495079853
            ],
            [
              -29.14803593253607,
              120.44505159755258
            ],
            [
              -29.14805469297255,
              120.44506324566456
            ],
            [
              -29.14806215424293,
              120.44506787843238
            ],
            [
              -29.148066291591643,
              120.44507044781852
            ],
            [
              -29.148067660057674,
              120.44507129769347
            ],
            [
              -29.148076695198988,
              120.44507690781543
            ],
            [
              -29.148085749898687,
              120.44507914582383
            ],
            [
              -29.148107577257242,
              120.44508454097371
            ],
            [
              -29.148139111912354,
              120.44509233575782
            ],
            [
              -29.14815215013397,
              120.44509555826018
            ],
            [
              -29.14815284479589,
              120.4450957969401
            ],
            [
              -29.14815289746545,
              120.44509581516093
            ],
            [
              -29.148153832756897,
              120.44509613625902
            ],
            [
              -29.148164498666475,
              120.4450997956609
            ],
            [
              -29.148171934659764,
              120.44510234709608
            ],
            [
              -29.148198299783296,
              120.44511139306783
            ],
            [
              -29.1482412531124,
              120.44512613141917
            ],
            [
              -29.148243702119466,
              120.44512697201412
            ],
            [
              -29.148251528557115,
              120.44512965662614
            ],
            [
              -29.14825340368747,
              120.44513030076604
            ],
            [
              -29.148264207602754,
              120.44513575612817
            ],
            [
              -29.148288656489495,
              120.44514810301622
            ],
            [
              -29.148288829552055,
              120.44514819019024
            ],
            [
              -29.148289215762496,
              120.44514838512598
            ],
            [
              -29.148326686562616,
              120.4451673080792
            ],
            [
              -29.148334759679305,
              120.44517138518691
            ],
            [
              -29.14834115676076,
              120.44517461489329
            ],
            [
              -29.14834343670169,
              120.44517576693565
            ],
            [
              -29.148347892590085,
              120.44517559907307
            ],
            [
              -29.14835070964255,
              120.44517549336366
            ],
            [
              -29.14837992226968,
              120.44517439813795
            ],
            [
              -29.148380528960626,
              120.44517437592455
            ],
            [
              -29.14838068040304,
              120.44517437011999
            ],
            [
              -29.148383355942514,
              120.44517592547433
            ],
            [
              -29.148402972435452,
              120.44518733562113
            ],
            [
              -29.14840026020412,
              120.44519643457288
            ],
            [
              -29.14840017460215,
              120.44519672339976
            ],
            [
              -29.148399325090345,
              120.44519957451307
            ],
            [
              -29.148384744793585,
              120.44524848668749
            ],
            [
              -29.148383874953304,
              120.44525140715417
            ],
            [
              -29.148381540840745,
              120.44525923687262
            ],
            [
              -29.148375008243722,
              120.44528115240583
            ],
            [
              -29.148372571532196,
              120.44528932583471
            ],
            [
              -29.14836519987323,
              120.44528693104367
            ],
            [
              -29.14836519352231,
              120.44528692914564
            ],
            [
              -29.148336788033017,
              120.44527770344078
            ],
            [
              -29.148316426832025,
              120.44527109120347
            ],
            [
              -29.148311137511612,
              120.4452693734499
            ],
            [
              -29.148302629149807,
              120.44525742419879
            ],
            [
              -29.148297797949482,
              120.44525063918992
            ],
            [
              -29.14829243560706,
              120.44524310791613
            ],
            [
              -29.148290984018125,
              120.44524106907784
            ],
            [
              -29.1482847772426,
              120.44523235227881
            ],
            [
              -29.148274147113206,
              120.44521742304141
            ],
            [
              -29.148261846639993,
              120.44520014798773
            ],
            [
              -29.148247259413502,
              120.44517966170591
            ],
            [
              -29.148244637103883,
              120.44517597888058
            ],
            [
              -29.148243966908648,
              120.44517503669914
            ],
            [
              -29.148241217600745,
              120.44517117512868
            ],
            [
              -29.148240235996234,
              120.44516979775082
            ],
            [
              -29.148233599130645,
              120.44516600981808
            ],
            [
              -29.14820581678636,
              120.44515015391289
            ],
            [
              -29.148204313755407,
              120.44514929606348
            ],
            [
              -29.148198964675192,
              120.44514624285843
            ],
            [
              -29.14816005097257,
              120.44512403437626
            ],
            [
              -29.148153363024203,
              120.44512021688506
            ],
            [
              -29.148150782885157,
              120.44511874446604
            ],
            [
              -29.148149116592318,
              120.44511779303528
            ],
            [
              -29.14814116928133,
              120.4451210192253
            ],
            [
              -29.148108526009942,
              120.44513426882472
            ],
            [
              -29.148087908436324,
              120.44514263646629
            ],
            [
              -29.148082889225893,
              120.44514467416202
            ],
            [
              -29.148085896851114,
              120.44514732290178
            ],
            [
              -29.148092302054962,
              120.44515296422983
            ],
            [
              -29.148070662725775,
              120.4451534999591
            ],
            [
              -29.148070195657446,
              120.4451535115224
            ],
            [
              -29.148063791050784,
              120.44515367008245
            ],
            [
              -29.148060345745684,
              120.44515375537848
            ],
            [
              -29.14805992285949,
              120.44515376584796
            ],
            [
              -29.148048890850095,
              120.44515403896929
            ],
            [
              -29.14804801983079,
              120.44515406053324
            ],
            [
              -29.14804375531287,
              120.44515054682459
            ],
            [
              -29.148043273212213,
              120.44515014873872
            ],
            [
              -29.14801822504827,
              120.44512951249712
            ],
            [
              -29.14799536823986,
              120.44511068098065
            ],
            [
              -29.147987476174873,
              120.44510417832977
            ],
            [
              -29.147980854409415,
              120.44509872323307
            ],
            [
              -29.147979827914032,
              120.44509787722343
            ],
            [
              -29.14797888223269,
              120.44509776807308
            ],
            [
              -29.147972500192065,
              120.4450970289636
            ],
            [
              -29.147961630217715,
              120.44509577103283
            ],
            [
              -29.147927295271472,
              120.44509179743042
            ],
            [
              -29.14788754840904,
              120.4450871984043
            ],
            [
              -29.14788209037028,
              120.4450865669274
            ],
            [
              -29.14787620105615,
              120.44508588447067
            ],
            [
              -29.147874964251177,
              120.44508574142317
            ],
            [
              -29.147870851492215,
              120.44508540650664
            ],
            [
              -29.147840687966696,
              120.44508295121905
            ],
            [
              -29.14784212504605,
              120.44507813001249
            ],
            [
              -29.14784865167707,
              120.44505623425687
            ],
            [
              -29.147851939611208,
              120.44504520561418
            ],
            [
              -29.147852662786068,
              120.44504277793992
            ],
            [
              -29.14785666267979,
              120.44504287107539
            ],
            [
              -29.147859694193055,
              120.44504294194316
            ],
            [
              -29.147881267713608,
              120.44504344880438
            ],
            [
              -29.147884828099063,
              120.44504353226878
            ],
            [
              -29.147885987811268,
              120.44504355904806
            ],
            [
              -29.147892591623894,
              120.44504457423147
            ],
            [
              -29.147926493721307,
              120.44504978551379
            ],
            [
              -29.147938649110767,
              120.4450516538785
            ],
            [
              -29.147941015950185,
              120.44505201763253
            ],
            [
              -29.1479485771059,
              120.4450490722973
            ],
            [
              -29.14794917168395,
              120.44504884074857
            ],
            [
              -29.147971415484633,
              120.44504017593421
            ],
            [
              -29.147992152228287,
              120.44503209717797
            ],
            [
              -29.147992707406893,
              120.4450318809912
            ],
            [
              -29.14799975546816,
              120.44502913538324
            ]
          ]
        ]
      },
      "properties": {
        "altitude": 424.7,
        "source": "SWK_S01_420_002",
        "block_id": "HG01",
        "density": 2.39604115525749,
        "volume": 936.735706076036,
        "tonnes": 2244.45730335737,
        "grade": 1.74208739973901,
        "source_type": "DIGBLOCK",
        "fillColor": "#F8D904"
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [
              -29.147255304416866,
              120.44455478523399
            ],
            [
              -29.14765869201056,
              120.44466966330722
            ],
            [
              -29.14771391749698,
              120.44468539028145
            ],
            [
              -29.147741527255047,
              120.44469092269388
            ],
            [
              -29.147945366252916,
              120.44473176993104
            ],
            [
              -29.147934704010012,
              120.44476754236048
            ],
            [
              -29.147852662786068,
              120.44504277793992
            ],
            [
              -29.147845956893143,
              120.44504062051504
            ],
            [
              -29.1477966757958,
              120.44502477287945
            ],
            [
              -29.147785656882306,
              120.44502029500133
            ],
            [
              -29.14770463142645,
              120.4449873640527
            ],
            [
              -29.14763816524167,
              120.44493160997585
            ],
            [
              -29.147629157937665,
              120.44492405494506
            ],
            [
              -29.147621799136108,
              120.44492077406846
            ],
            [
              -29.14756749703649,
              120.44489656373933
            ],
            [
              -29.147559879326124,
              120.44489597752394
            ],
            [
              -29.14750390027084,
              120.44489167462982
            ],
            [
              -29.147457677638418,
              120.44487253596897
            ],
            [
              -29.147451388103867,
              120.44486993151587
            ],
            [
              -29.147446645462438,
              120.44487038908139
            ],
            [
              -29.147411833441918,
              120.44487375119154
            ],
            [
              -29.147407175504508,
              120.4448726909259
            ],
            [
              -29.147373005143745,
              120.44486490909703
            ],
            [
              -29.14732542578476,
              120.44483858609154
            ],
            [
              -29.14731894066771,
              120.44483499792014
            ],
            [
              -29.14731378011086,
              120.4448319914674
            ],
            [
              -29.147275942089134,
              120.44480994674616
            ],
            [
              -29.14727097027202,
              120.44480827460438
            ],
            [
              -29.147234525993472,
              120.44479601629945
            ],
            [
              -29.147195592386613,
              120.44477569840622
            ],
            [
              -29.147190282051838,
              120.44477292688121
            ],
            [
              -29.147197647109195,
              120.44474821640954
            ],
            [
              -29.147255304416866,
              120.44455478523399
            ]
          ]
        ]
      },
      "properties": {
        "altitude": 424.7,
        "source": "SWK_S01_420_003",
        "block_id": "WS01",
        "density": 2.3596609942512,
        "volume": 5008.4336010695,
        "tonnes": 11818.2054107408,
        "grade": 0.0228667376329168,
        "source_type": "DIGBLOCK",
        "fillColor": "#D2D2D2"
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [
              -29.14849749136571,
              120.44487023759719
            ],
            [
              -29.148569508545,
              120.44489508847145
            ],
            [
              -29.148579086980146,
              120.44489839353977
            ],
            [
              -29.148593256869557,
              120.44490726462205
            ],
            [
              -29.148595120277413,
              120.44490842902941
            ],
            [
              -29.148617388776643,
              120.44492606975727
            ],
            [
              -29.14878148342027,
              120.4450560672209
            ],
            [
              -29.148783680893544,
              120.44505833422951
            ],
            [
              -29.14880085220144,
              120.44507605394875
            ],
            [
              -29.148807598326915,
              120.4450850955157
            ],
            [
              -29.148858015455183,
              120.44515268513997
            ],
            [
              -29.14885997276086,
              120.44515635978638
            ],
            [
              -29.148875648725568,
              120.44518601343674
            ],
            [
              -29.148877301670407,
              120.44519070989124
            ],
            [
              -29.148889957977143,
              120.44522715593371
            ],
            [
              -29.148903056431813,
              120.44529429665383
            ],
            [
              -29.148904934136148,
              120.44530391812089
            ],
            [
              -29.14890829314821,
              120.44530829385444
            ],
            [
              -29.148930366812486,
              120.44533705029302
            ],
            [
              -29.148934655610365,
              120.44534112760552
            ],
            [
              -29.148965258613334,
              120.44537021344041
            ],
            [
              -29.149032971045933,
              120.44543039650593
            ],
            [
              -29.149042563353188,
              120.44543892166568
            ],
            [
              -29.149061016721436,
              120.44544237190412
            ],
            [
              -29.149193948988508,
              120.44546726088132
            ],
            [
              -29.149205172984974,
              120.44547156627607
            ],
            [
              -29.149206364154963,
              120.44547201258294
            ],
            [
              -29.149212938856888,
              120.4454758997308
            ],
            [
              -29.149263920628243,
              120.4455067039771
            ],
            [
              -29.14926512650637,
              120.44550891436931
            ],
            [
              -29.149276934483268,
              120.44553092276692
            ],
            [
              -29.149278506771537,
              120.44553891070123
            ],
            [
              -29.149278676535495,
              120.44553972346849
            ],
            [
              -29.149274590782838,
              120.44558677005215
            ],
            [
              -29.149274143959097,
              120.44559233547925
            ],
            [
              -29.149272971765015,
              120.445594255344
            ],
            [
              -29.149263078836306,
              120.44561064026607
            ],
            [
              -29.14926272731517,
              120.44561122341543
            ],
            [
              -29.1492478646037,
              120.44560740988113
            ],
            [
              -29.149240129119022,
              120.44560542586291
            ],
            [
              -29.149221973349402,
              120.44560149756829
            ],
            [
              -29.14909515304886,
              120.44557430216963
            ],
            [
              -29.14909216192073,
              120.44557346367434
            ],
            [
              -29.14906257416623,
              120.44556487238195
            ],
            [
              -29.14905787479808,
              120.44556334244353
            ],
            [
              -29.149019313517613,
              120.44555014752802
            ],
            [
              -29.149010509379156,
              120.44554690440307
            ],
            [
              -29.14895817333464,
              120.44552739040378
            ],
            [
              -29.148949799984432,
              120.44552374714603
            ],
            [
              -29.148889812654847,
              120.44549767823038
            ],
            [
              -29.14881715009088,
              120.44545989264925
            ],
            [
              -29.14880404547086,
              120.44545300000757
            ],
            [
              -29.14877305980039,
              120.44543577326075
            ],
            [
              -29.148713883574274,
              120.4454010101368
            ],
            [
              -29.148704759371853,
              120.44539564879115
            ],
            [
              -29.148699250174214,
              120.44539195725588
            ],
            [
              -29.14865706943577,
              120.4453636667749
            ],
            [
              -29.14865370751316,
              120.44536112441082
            ],
            [
              -29.148631105736534,
              120.4453438854123
            ],
            [
              -29.14862571849711,
              120.44534053409086
            ],
            [
              -29.14862498359467,
              120.44534007751982
            ],
            [
              -29.14862129142565,
              120.44533710556321
            ],
            [
              -29.14859426071911,
              120.44531534778183
            ],
            [
              -29.148593359300985,
              120.44531481620601
            ],
            [
              -29.148586761916818,
              120.44531092245705
            ],
            [
              -29.148583597948384,
              120.44530873178259
            ],
            [
              -29.148565622718134,
              120.44529601492597
            ],
            [
              -29.148556206020462,
              120.44528998054818
            ],
            [
              -29.14855089246016,
              120.44528703948636
            ],
            [
              -29.148516214790646,
              120.44526822200234
            ],
            [
              -29.14851192466493,
              120.44526643943236
            ],
            [
              -29.14848054429207,
              120.44525339677634
            ],
            [
              -29.148453431048218,
              120.44524617994756
            ],
            [
              -29.148449461817062,
              120.44524509335922
            ],
            [
              -29.14844453510821,
              120.44524323200923
            ],
            [
              -29.148434713460905,
              120.4452401816184
            ],
            [
              -29.14843297058287,
              120.4452396133287
            ],
            [
              -29.14842998958677,
              120.44523888044175
            ],
            [
              -29.148408151020043,
              120.4452335122431
            ],
            [
              -29.148392917482845,
              120.44522870294806
            ],
            [
              -29.148390837339182,
              120.44522804641151
            ],
            [
              -29.14840322173368,
              120.44518650118266
            ],
            [
              -29.14849749136571,
              120.44487023759719
            ]
          ]
        ]
      },
      "properties": {
        "altitude": 424.7,
        "source": "SWK_S01_420_001",
        "block_id": "WS01",
        "density": 2.37145090347944,
        "volume": 5867.00322460444,
        "tonnes": 13913.310097705,
        "grade": 0.141742556598628,
        "source_type": "DIGBLOCK",
        "fillColor": "#D2D2D2"
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [
              -29.14691831866269,
              120.44446916800533
            ],
            [
              -29.14696093006204,
              120.44447203625259
            ],
            [
              -29.14696605305121,
              120.4444724118956
            ],
            [
              -29.147000676242776,
              120.44448227149427
            ],
            [
              -29.147255304416866,
              120.44455478523399
            ],
            [
              -29.147197647109195,
              120.44474821640954
            ],
            [
              -29.147190282051838,
              120.44477292688121
            ],
            [
              -29.14717959550699,
              120.44477211043034
            ],
            [
              -29.14710129969747,
              120.44476612407945
            ],
            [
              -29.14709102664028,
              120.44476168430508
            ],
            [
              -29.14701577515822,
              120.44472916157692
            ],
            [
              -29.147005911287696,
              120.44472356794576
            ],
            [
              -29.146933674945537,
              120.44468259969145
            ],
            [
              -29.14685595826516,
              120.44465089442421
            ],
            [
              -29.14684534631194,
              120.44464656479492
            ],
            [
              -29.14680060079445,
              120.44463761140413
            ],
            [
              -29.14679448917799,
              120.44463638881909
            ],
            [
              -29.146707532666856,
              120.44459208271455
            ],
            [
              -29.146697113123864,
              120.44458677415908
            ],
            [
              -29.146740284345633,
              120.4445284498858
            ],
            [
              -29.146745741298393,
              120.44452108244802
            ],
            [
              -29.1467492264158,
              120.44451911254198
            ],
            [
              -29.146779879636707,
              120.44450179974508
            ],
            [
              -29.146796518071746,
              120.44449787948135
            ],
            [
              -29.14691831866269,
              120.44446916800533
            ]
          ]
        ]
      },
      "properties": {
        "altitude": 424.7,
        "source": "SWK_S01_420_004",
        "block_id": "WS01",
        "density": 2.34089620040974,
        "volume": 2644.76635351479,
        "tonnes": 6191.12350791429,
        "grade": 0.0146854510183056,
        "source_type": "DIGBLOCK",
        "fillColor": "#D2D2D2"
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [
              -29.147945366252916,
              120.44473176993104
            ],
            [
              -29.1480598785398,
              120.44475471751144
            ],
            [
              -29.14807578025461,
              120.44475790400503
            ],
            [
              -29.14819778183919,
              120.44477253357583
            ],
            [
              -29.148214387784982,
              120.44477452189743
            ],
            [
              -29.148234114659278,
              120.4447796124111
            ],
            [
              -29.148236663970078,
              120.44478027273504
            ],
            [
              -29.148267923011392,
              120.44479102045534
            ],
            [
              -29.14849749136571,
              120.44487023759719
            ],
            [
              -29.148413898507663,
              120.44515068099322
            ],
            [
              -29.148402972435452,
              120.44518733562113
            ],
            [
              -29.148383358686736,
              120.44517592746165
            ],
            [
              -29.14838068040304,
              120.44517437011999
            ],
            [
              -29.148347910623617,
              120.44517559862659
            ],
            [
              -29.14834343670169,
              120.44517576693565
            ],
            [
              -29.148264218540454,
              120.44513576202313
            ],
            [
              -29.14825340368747,
              120.44513030076604
            ],
            [
              -29.148164307981894,
              120.44509973050342
            ],
            [
              -29.14815214833062,
              120.44509555830483
            ],
            [
              -29.148085753524995,
              120.44507914676166
            ],
            [
              -29.148076695198988,
              120.44507690781543
            ],
            [
              -29.14800898870465,
              120.44503486801881
            ],
            [
              -29.14799975546816,
              120.44502913538324
            ],
            [
              -29.14799271367943,
              120.44503187878065
            ],
            [
              -29.147941015950185,
              120.44505201763253
            ],
            [
              -29.14793442119354,
              120.44505100427946
            ],
            [
              -29.14788598961462,
              120.44504355900341
            ],
            [
              -29.14785665815182,
              120.44504287015987
            ],
            [
              -29.147852663648546,
              120.44504277586331
            ],
            [
              -29.14786334039568,
              120.44500695585786
            ],
            [
              -29.147945366252916,
              120.44473176993104
            ]
          ]
        ]
      },
      "properties": {
        "altitude": 424.7,
        "source": "SWK_S01_420_002",
        "block_id": "WS02",
        "density": 2.39552598259106,
        "volume": 4812.27223204868,
        "tonnes": 11527.9231671741,
        "grade": 0.0251355196796102,
        "source_type": "DIGBLOCK",
        "fillColor": "#969696"
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [
              -29.146681050295744,
              120.44464430795807
            ],
            [
              -29.146783633836364,
              120.44468137712124
            ],
            [
              -29.14680026316069,
              120.44468667066076
            ],
            [
              -29.14692204705745,
              120.44472544303116
            ],
            [
              -29.146989753799012,
              120.44477931106444
            ],
            [
              -29.14699899907302,
              120.4447866669566
            ],
            [
              -29.147003924066933,
              120.44479297683796
            ],
            [
              -29.147040005247764,
              120.44483920463955
            ],
            [
              -29.14702913604207,
              120.44483633234196
            ],
            [
              -29.14694952544295,
              120.44481528905023
            ],
            [
              -29.146950971671473,
              120.44480976579813
            ],
            [
              -29.146951169278246,
              120.44480901177683
            ],
            [
              -29.146907661264564,
              120.4447922948975
            ],
            [
              -29.14690172067678,
              120.44479001271155
            ],
            [
              -29.146870899251407,
              120.44477733160652
            ],
            [
              -29.146866690389505,
              120.444775600504
            ],
            [
              -29.146866102157265,
              120.44477758294246
            ],
            [
              -29.146861793784993,
              120.44479210082463
            ],
            [
              -29.146836558302784,
              120.44478543063667
            ],
            [
              -29.14664098126477,
              120.44473373605476
            ],
            [
              -29.146643929924746,
              120.44471216137205
            ],
            [
              -29.14664429985459,
              120.44470947015512
            ],
            [
              -29.146647227776725,
              120.44470099182416
            ],
            [
              -29.146668508481795,
              120.44463977538372
            ],
            [
              -29.146681050295744,
              120.44464430795807
            ]
          ]
        ]
      },
      "properties": {
        "altitude": 424.7,
        "source": "SWK_S01_420_004",
        "block_id": "WS02",
        "density": 2.39801026501716,
        "volume": 769.063840630291,
        "tonnes": 1844.22298428496,
        "grade": 0.464390630616656,
        "source_type": "DIGBLOCK",
        "fillColor": "#969696"
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [
              -29.14715608901363,
              120.4448876371725
            ],
            [
              -29.14715608477962,
              120.44488765166392
            ],
            [
              -29.147162172145258,
              120.4448894472477
            ],
            [
              -29.14720679765451,
              120.44490260770752
            ],
            [
              -29.147234997147947,
              120.44493635412348
            ],
            [
              -29.14723884403235,
              120.44494095713296
            ],
            [
              -29.14724408066272,
              120.44494355374306
            ],
            [
              -29.14728248761603,
              120.44496260536796
            ],
            [
              -29.14729790603986,
              120.44496797930557
            ],
            [
              -29.147411109505764,
              120.44500743626311
            ],
            [
              -29.14742591111155,
              120.44501102510031
            ],
            [
              -29.147534736247668,
              120.44503741032197
            ],
            [
              -29.147571519767578,
              120.44510291251517
            ],
            [
              -29.14757652229954,
              120.44511182142612
            ],
            [
              -29.14759834254839,
              120.44515254316231
            ],
            [
              -29.147601310600812,
              120.44515808253237
            ],
            [
              -29.14764307070805,
              120.4451770903315
            ],
            [
              -29.14764875186137,
              120.44517967595759
            ],
            [
              -29.147659547819863,
              120.44518438338872
            ],
            [
              -29.14773885278915,
              120.44521896221772
            ],
            [
              -29.14779688955432,
              120.44520525052472
            ],
            [
              -29.14780478973859,
              120.44520338403434
            ],
            [
              -29.147801311062892,
              120.44521505451397
            ],
            [
              -29.147800982101437,
              120.44521615810075
            ],
            [
              -29.14779918130093,
              120.44522219987203
            ],
            [
              -29.147739560329097,
              120.44542221706968
            ],
            [
              -29.14773951879213,
              120.44542235682654
            ],
            [
              -29.147737454313308,
              120.44542928373276
            ],
            [
              -29.147557415957092,
              120.4453635798199
            ],
            [
              -29.14755550917137,
              120.44536288405415
            ],
            [
              -29.147531821038317,
              120.44535423935818
            ],
            [
              -29.14752984568729,
              120.44535335415323
            ],
            [
              -29.14752259215516,
              120.44535010558103
            ],
            [
              -29.147499637781838,
              120.44533982422932
            ],
            [
              -29.147408796836327,
              120.4452988658267
            ],
            [
              -29.147174666629237,
              120.44519335058968
            ],
            [
              -29.14710938847884,
              120.44516392755328
            ],
            [
              -29.14708269577488,
              120.44515189631484
            ],
            [
              -29.14708257653831,
              120.44515184069274
            ],
            [
              -29.147077972944366,
              120.44514970418834
            ],
            [
              -29.147082718263665,
              120.44513378305524
            ],
            [
              -29.14712117101124,
              120.44500478125896
            ],
            [
              -29.147199686022986,
              120.44502395898259
            ],
            [
              -29.147210399687996,
              120.44502657516796
            ],
            [
              -29.147252300286816,
              120.44505488442371
            ],
            [
              -29.147258013895744,
              120.44505874552854
            ],
            [
              -29.147306798760358,
              120.44506536920018
            ],
            [
              -29.14731345004884,
              120.44506627222447
            ],
            [
              -29.147319928206148,
              120.44504523995246
            ],
            [
              -29.147320810784628,
              120.4450423726358
            ],
            [
              -29.14731445605781,
              120.4450397554023
            ],
            [
              -29.147267844390065,
              120.44502055645604
            ],
            [
              -29.147228091872286,
              120.44500067287343
            ],
            [
              -29.147222671732667,
              120.44499796160076
            ],
            [
              -29.147144142222672,
              120.444967764128
            ],
            [
              -29.147133433267868,
              120.4449636454628
            ],
            [
              -29.147136152233394,
              120.444954521791
            ],
            [
              -29.14715608901363,
              120.4448876371725
            ]
          ]
        ]
      },
      "properties": {
        "altitude": 424.7,
        "source": "SWK_S01_420_003",
        "block_id": "WS03",
        "density": 2.39623247856825,
        "volume": 4700.98579064625,
        "tonnes": 11264.6548328344,
        "grade": 0.169216157985238,
        "source_type": "DIGBLOCK",
        "fillColor": null
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [
              -29.14767401130136,
              120.44509128582092
            ],
            [
              -29.147678908775923,
              120.44507520770898
            ],
            [
              -29.147690744559046,
              120.44507734603002
            ],
            [
              -29.147777741864846,
              120.44509306351985
            ],
            [
              -29.147785282882687,
              120.44509185228631
            ],
            [
              -29.147840687966696,
              120.44508295121905
            ],
            [
              -29.147840492142972,
              120.44508360963373
            ],
            [
              -29.147840358183092,
              120.44508405893747
            ],
            [
              -29.147839456100215,
              120.44508708603269
            ],
            [
              -29.147817364005885,
              120.44516119927522
            ],
            [
              -29.147816386473025,
              120.445164480004
            ],
            [
              -29.147815590356753,
              120.44516715097316
            ],
            [
              -29.147767392688692,
              120.44515220131503
            ],
            [
              -29.147760831652725,
              120.44515016566764
            ],
            [
              -29.147750357759442,
              120.44514337858223
            ],
            [
              -29.147673344853732,
              120.44509347162338
            ],
            [
              -29.14767401130136,
              120.44509128582092
            ]
          ]
        ]
      },
      "properties": {
        "altitude": 424.7,
        "source": "SWK_S01_420_003",
        "block_id": "WS03",
        "density": 2.39623247856825,
        "volume": 4700.98579064625,
        "tonnes": 11264.6548328344,
        "grade": 0.169216157985238,
        "source_type": "DIGBLOCK",
        "fillColor": null
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [
              -29.148390837339182,
              120.44522804641151
            ],
            [
              -29.14840607087639,
              120.4452328557064
            ],
            [
              -29.148408151020043,
              120.4452335122431
            ],
            [
              -29.14842998958677,
              120.44523888044175
            ],
            [
              -29.14843297058287,
              120.4452396133287
            ],
            [
              -29.14844569538602,
              120.44524376128572
            ],
            [
              -29.148447036646576,
              120.44524417818091
            ],
            [
              -29.148447710844096,
              120.44524443175578
            ],
            [
              -29.148476669266405,
              120.44525233046309
            ],
            [
              -29.14848040229806,
              120.44525333041301
            ],
            [
              -29.14851196106511,
              120.44526645600088
            ],
            [
              -29.148516214790646,
              120.44526822200234
            ],
            [
              -29.14855089246016,
              120.44528703948636
            ],
            [
              -29.148556206020462,
              120.44528998054818
            ],
            [
              -29.148565622718134,
              120.44529601492597
            ],
            [
              -29.148583597948384,
              120.44530873178259
            ],
            [
              -29.148586761916818,
              120.44531092245705
            ],
            [
              -29.148593359300985,
              120.44531481620601
            ],
            [
              -29.14859426071911,
              120.44531534778183
            ],
            [
              -29.14862129142565,
              120.44533710556321
            ],
            [
              -29.14862498359467,
              120.44534007751982
            ],
            [
              -29.148630335139643,
              120.4453434019789
            ],
            [
              -29.14863107827473,
              120.44534386451195
            ],
            [
              -29.14865387661591,
              120.4453612404571
            ],
            [
              -29.148657159936228,
              120.44536372927509
            ],
            [
              -29.148699031832308,
              120.44539181365485
            ],
            [
              -29.148704611399573,
              120.44539555277424
            ],
            [
              -29.148779875094423,
              120.44543950440226
            ],
            [
              -29.148788448451885,
              120.44544455260518
            ],
            [
              -29.148792200782815,
              120.44544661157303
            ],
            [
              -29.148861570185588,
              120.44548266900068
            ],
            [
              -29.148869806045955,
              120.44548695484237
            ],
            [
              -29.148878186287902,
              120.44549181052855
            ],
            [
              -29.148888165396553,
              120.44549682599646
            ],
            [
              -29.148889832687658,
              120.44549768801079
            ],
            [
              -29.148949802709055,
              120.44552374810623
            ],
            [
              -29.14895817333464,
              120.44552739040378
            ],
            [
              -29.149011411327393,
              120.44554722736036
            ],
            [
              -29.149020222738027,
              120.44555047338824
            ],
            [
              -29.1490594517674,
              120.44556382030612
            ],
            [
              -29.149063044977396,
              120.44556500973414
            ],
            [
              -29.149066915727744,
              120.44556613577211
            ],
            [
              -29.149094857162194,
              120.44557425502948
            ],
            [
              -29.149221345274285,
              120.44560134458366
            ],
            [
              -29.149239719386387,
              120.445605321938
            ],
            [
              -29.149262331166447,
              120.44561112223712
            ],
            [
              -29.149262728216836,
              120.44561122339312
            ],
            [
              -29.14926201723577,
              120.44561239913703
            ],
            [
              -29.149261268644626,
              120.44561288010325
            ],
            [
              -29.14924193642949,
              120.44562530901361
            ],
            [
              -29.149240745505107,
              120.44562605783767
            ],
            [
              -29.14921491704062,
              120.4456340776591
            ],
            [
              -29.149024198124977,
              120.44569314188895
            ],
            [
              -29.149022143481297,
              120.4456928762366
            ],
            [
              -29.14900264851459,
              120.44569048347898
            ],
            [
              -29.148946426645228,
              120.44565349309241
            ],
            [
              -29.148939065812506,
              120.44564859160361
            ],
            [
              -29.148820626741845,
              120.44557716812922
            ],
            [
              -29.14880429393347,
              120.44556731873521
            ],
            [
              -29.14880334445152,
              120.44556696304309
            ],
            [
              -29.14879083446612,
              120.44556334100183
            ],
            [
              -29.14878997454329,
              120.44556309304924
            ],
            [
              -29.14878938390638,
              120.44556305834358
            ],
            [
              -29.14876753675013,
              120.44556679199238
            ],
            [
              -29.14860590916817,
              120.44559399878648
            ],
            [
              -29.148603907526972,
              120.44559376881917
            ],
            [
              -29.14858874320732,
              120.44559202008132
            ],
            [
              -29.14854395346007,
              120.4455816912867
            ],
            [
              -29.14853799139125,
              120.44558031592491
            ],
            [
              -29.148510623375465,
              120.44557090310767
            ],
            [
              -29.148309292963454,
              120.4455016161492
            ],
            [
              -29.14838148062329,
              120.4452594377228
            ],
            [
              -29.148390837339182,
              120.44522804641151
            ]
          ]
        ]
      },
      "properties": {
        "altitude": 424.7,
        "source": "SWK_S01_420_001",
        "block_id": "WS02",
        "density": 2.39666747985558,
        "volume": 4104.49274964036,
        "tonnes": 9837.10429436607,
        "grade": 0.247416111310224,
        "source_type": "DIGBLOCK",
        "fillColor": "#969696"
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [
              -29.14664098126477,
              120.44473373605476
            ],
            [
              -29.146836558302784,
              120.44478543063667
            ],
            [
              -29.146861793784993,
              120.44479210082463
            ],
            [
              -29.146857966068648,
              120.44480500270514
            ],
            [
              -29.1468574430906,
              120.4448067646466
            ],
            [
              -29.146867722381057,
              120.44481077472184
            ],
            [
              -29.146943014804634,
              120.44484014888567
            ],
            [
              -29.146948743483662,
              120.44481827615247
            ],
            [
              -29.14694952544295,
              120.44481528905023
            ],
            [
              -29.14702913604207,
              120.44483633234196
            ],
            [
              -29.147040005247764,
              120.44483920463955
            ],
            [
              -29.147068253258368,
              120.44487539858564
            ],
            [
              -29.14707210927747,
              120.44488033841651
            ],
            [
              -29.147082197599378,
              120.4448811953803
            ],
            [
              -29.147156136450242,
              120.44488747569035
            ],
            [
              -29.147136159054863,
              120.44495450106983
            ],
            [
              -29.147133433267868,
              120.4449636454628
            ],
            [
              -29.147063041121577,
              120.44494358743465
            ],
            [
              -29.147053427442163,
              120.44494084640364
            ],
            [
              -29.147043103642513,
              120.44493606361938
            ],
            [
              -29.146967408482944,
              120.44490099403346
            ],
            [
              -29.146891368508165,
              120.44486477902551
            ],
            [
              -29.14688098750948,
              120.44485983530892
            ],
            [
              -29.146793389909913,
              120.44485866027578
            ],
            [
              -29.146781428588103,
              120.4448585001644
            ],
            [
              -29.146746884796727,
              120.44483984626174
            ],
            [
              -29.146742166903124,
              120.44483729848073
            ],
            [
              -29.14673296544679,
              120.44483408278039
            ],
            [
              -29.146653123709612,
              120.44480617363833
            ],
            [
              -29.146641678761725,
              120.44474963027034
            ],
            [
              -29.146639963250387,
              120.44474118264692
            ],
            [
              -29.14664092106681,
              120.44473417427872
            ],
            [
              -29.14664098126477,
              120.44473373605476
            ]
          ]
        ]
      },
      "properties": {
        "altitude": 424.7,
        "source": "SWK_S01_420_004",
        "block_id": "WS03",
        "density": 2.39998200103603,
        "volume": 2155.91757131445,
        "tonnes": 5174.16336687199,
        "grade": 0.154551542614705,
        "source_type": "DIGBLOCK",
        "fillColor": null
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [
              -29.14669336478992,
              120.44490896476206
            ],
            [
              -29.146755497128808,
              120.44492111834509
            ],
            [
              -29.14676197494169,
              120.44492238531627
            ],
            [
              -29.146798777951446,
              120.44493656664876
            ],
            [
              -29.14680380441545,
              120.44493850256143
            ],
            [
              -29.14685669862356,
              120.44493393445289
            ],
            [
              -29.146863921581833,
              120.4449333106709
            ],
            [
              -29.14694172319075,
              120.44494965948637
            ],
            [
              -29.146952347455226,
              120.44495189251866
            ],
            [
              -29.14696338627354,
              120.4449544821451
            ],
            [
              -29.147044269876698,
              120.44497345319269
            ],
            [
              -29.14705350339651,
              120.44497721480917
            ],
            [
              -29.14712117101124,
              120.44500478125896
            ],
            [
              -29.14708271912615,
              120.44513378097867
            ],
            [
              -29.147077973787248,
              120.44514970108462
            ],
            [
              -29.14704264573384,
              120.44513329739823
            ],
            [
              -29.14678254078195,
              120.44501248871376
            ],
            [
              -29.146778114389885,
              120.44500942709554
            ],
            [
              -29.146742762351828,
              120.44498462749581
            ],
            [
              -29.14674010375417,
              120.44498159610156
            ],
            [
              -29.146718821546294,
              120.44495678318347
            ],
            [
              -29.146716345799476,
              120.44495217707703
            ],
            [
              -29.14669336478992,
              120.44490896476206
            ]
          ]
        ]
      },
      "properties": {
        "altitude": 424.7,
        "source": "SWK_S01_420_004",
        "block_id": "WS03",
        "density": 2.39998200103603,
        "volume": 2155.91757131445,
        "tonnes": 5174.16336687199,
        "grade": 0.154551542614705,
        "source_type": "DIGBLOCK",
        "fillColor": null
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [
              -29.147840687966696,
              120.44508295121905
            ],
            [
              -29.147870805428337,
              120.44508540353658
            ],
            [
              -29.147874911855972,
              120.44508573758225
            ],
            [
              -29.147880378029402,
              120.4450863698853
            ],
            [
              -29.14792055883309,
              120.44509101776967
            ],
            [
              -29.14792766593858,
              120.44509183963464
            ],
            [
              -29.147979827914032,
              120.44509787722343
            ],
            [
              -29.1480436671252,
              120.44515051098583
            ],
            [
              -29.148052308889607,
              120.44515763118149
            ],
            [
              -29.148060451165733,
              120.44516448217557
            ],
            [
              -29.14811972030344,
              120.44521432612208
            ],
            [
              -29.148129021422243,
              120.4452254613707
            ],
            [
              -29.14819718132336,
              120.44530706391289
            ],
            [
              -29.148240353683565,
              120.44531886202935
            ],
            [
              -29.148246245343497,
              120.44532047135941
            ],
            [
              -29.148247651413477,
              120.44531676690406
            ],
            [
              -29.14825795874148,
              120.44528961983043
            ],
            [
              -29.148252215223913,
              120.44528589301098
            ],
            [
              -29.14821012349568,
              120.44525858083266
            ],
            [
              -29.148200322856656,
              120.44524972796043
            ],
            [
              -29.148128489894656,
              120.44518483408545
            ],
            [
              -29.14812301688348,
              120.44518001335386
            ],
            [
              -29.148082889225893,
              120.44514467416202
            ],
            [
              -29.14814116747798,
              120.44512101926995
            ],
            [
              -29.148149116592318,
              120.44511779303528
            ],
            [
              -29.14822929707006,
              120.44516355445795
            ],
            [
              -29.148240235996234,
              120.44516979775082
            ],
            [
              -29.148302625386332,
              120.44525741607096
            ],
            [
              -29.148311139314963,
              120.44526937340524
            ],
            [
              -29.148365192620624,
              120.44528692916798
            ],
            [
              -29.148372571532196,
              120.44528932583471
            ],
            [
              -29.148365408997996,
              120.4453133553706
            ],
            [
              -29.148309292963454,
              120.4455016161492
            ],
            [
              -29.14800652891605,
              120.44539741334184
            ],
            [
              -29.147965622489554,
              120.44538333740009
            ],
            [
              -29.147942084543818,
              120.4453748102139
            ],
            [
              -29.14790719992552,
              120.44547580209866
            ],
            [
              -29.14790208935365,
              120.44548936577871
            ],
            [
              -29.147737454313308,
              120.44542928373276
            ],
            [
              -29.147741644624123,
              120.445415383186
            ],
            [
              -29.147801348678282,
              120.44521508749423
            ],
            [
              -29.14780478973859,
              120.44520338403434
            ],
            [
              -29.14783556059796,
              120.44520310832138
            ],
            [
              -29.147839749237082,
              120.44520307039316
            ],
            [
              -29.147882431296544,
              120.4452166881596
            ],
            [
              -29.147888242824294,
              120.4452185419821
            ],
            [
              -29.14798661402749,
              120.44520939834649
            ],
            [
              -29.148000011747353,
              120.44520815310898
            ],
            [
              -29.148002474425084,
              120.44517921185331
            ],
            [
              -29.14800281051692,
              120.44517526671294
            ],
            [
              -29.14799716494567,
              120.44517530269
            ],
            [
              -29.14795572739543,
              120.44517556605919
            ],
            [
              -29.147860751846153,
              120.445174739947
            ],
            [
              -29.147847813557643,
              120.44517462762892
            ],
            [
              -29.147819451309775,
              120.44516804704178
            ],
            [
              -29.147815590356753,
              120.44516715097316
            ],
            [
              -29.14781859677642,
              120.44515706444089
            ],
            [
              -29.147840687966696,
              120.44508295121905
            ]
          ]
        ]
      },
      "properties": {
        "altitude": 424.7,
        "source": "SWK_S01_420_002",
        "block_id": "WS02",
        "density": 2.4,
        "volume": 3858.80273404657,
        "tonnes": 9261.12656171176,
        "grade": 0.268882315489567,
        "source_type": "DIGBLOCK",
        "fillColor": "#969696"
      }
    }
  ]

const MapGeofence = () => {

    document.title = "Map | FMS Live";

    const [markers, setMarkers] = useState<MarkerData[]>([]);
    const [selectedFence, setSelectedFence]: any = useState({});
    const [geofences, setGeofences] = useState<any[]>([]);
    const [modal, setModal] = useState(false);
    const [newGeofenceName, setNewGeofenceName] = useState("");

    const mapRef = useRef<Leaflet.Map | null>(null);
    const drawItems = new Leaflet.FeatureGroup();
    const origin: Leaflet.LatLngExpression = [-29.160331938574046, 120.44974338024406];

    const rippleIcon = (eq) => {
        const rippleStyles = `
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            border-radius: 50%;
            width: 20px;
            height: 20px;
            background-color: ${eq.color};
            animation: ripple 1s infinite;`;

        const textStyle = `
            background-color: white;
            position: absolute;
            top: -96px;
            left: -46px;
            border: 4px solid ${eq.color};
            border-radius: 20px;
            font-size: 20px;
            color: ${eq.color};
            font-weight: 600;
            padding-left: 12px;
            padding-right: 12px;
            width: 100px;
            text-align: center;`;

        const isNotActive: boolean = eq.status.toLowerCase() != 'active';
        const standardIconTemplate = `<div style="${textStyle}">${eq.name}</div>
            <div id="imageContainer" style="position: absolute;bottom: 5px;transform: translateX(-40%); z-index:1;">
              <img src="${standbyTruck}" alt="Description of the image">
            </div>`

        const icon = Leaflet.divIcon({
            className: 'marker',
            html: isNotActive ? `${standardIconTemplate}<div class="ripple" style="${rippleStyles}"></div>` : standardIconTemplate,
        });
        return icon
    }

    // Function to update marker position
    const updateMarkerPosition = (markerId: string, newPosition: Leaflet.LatLngExpression, duration: number = 1000) => {
        setMarkers(prevMarkers =>
            prevMarkers.map(markerData => {
                if (markerData.id === markerId) {
                    markerData.marker.slideTo(newPosition, { duration });
                }
                return markerData;
            })
        );
    };

    useEffect(() => {
        if (!mapRef.current) {
            mapRef.current = Leaflet.map('map', {
                center: origin,
                zoom: 13,
                attributionControl: false
            });

            Leaflet.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(mapRef.current);


            mapRef.current.addLayer(drawItems);
            const drawControl = new Leaflet.Control.Draw({
                edit: {
                    featureGroup: drawItems
                },
                draw: {
                    polyline: false,
                    circlemarker: false,
                    marker: false
                }
            });

            mapRef.current.addControl(drawControl);
            // mapRef.current.tap?.enable();
            mapRef.current.on('draw:created', function (event: Leaflet.LeafletEvent) {
                let type = (event as Leaflet.DrawEvents.Created).layerType;
                let layer = (event as Leaflet.DrawEvents.Created).layer;
                updateGeoFences(type, layer);
                toggle();
                drawItems.addLayer(layer);
            });

            drawItems.on('click', function (event: Leaflet.LeafletEvent) {
                let layer = event.propagatedFrom;
                let geofence = geofences.find((fence) => fence.layer.id === layer.id);
                if (geofence && !geofence.name) {
                    setSelectedFence(geofence);
                } else {
                    setNewGeofenceName(geofence.name);
                }
                toggle();
            });

            var myLayer = Leaflet.geoJSON().addTo(mapRef.current);
            
            geojsons.forEach((json) => {
                myLayer.addData(json);
            })
        }

        addMarkers();
    }, []);

    const drawFeature = (geojson: any) => {
        let layer;
        if (geojson.properties.radius) {
            layer = Leaflet.circle(geojson.geometry.coordinates, { radius: geojson.properties.radius, fillColor: geojson.properties.fillColor, color: geojson.properties.color, weight: 1 });
            layer.id = new Date();
            drawItems.addLayer(layer);
        } else {
            layer = Leaflet.polygon(geojson.geometry.coordinates, { fillColor: geojson.properties.fillColor, color: "#000", weight: 1 }).addTo(mapRef.current!);
            layer.id = new Date();
            drawItems.addLayer(layer);
        }
        geofences.push({ layer: layer, name: geojson.properties.name })
        setGeofences([...geofences]);
    }

    const updateGeoFences = (type: string, layer: any) => {
        layer.id = Date.now();
        let geofence = { layer: layer, type: type };
        geofences.push(geofence)
        setGeofences([...geofences]);
        setSelectedFence(geofence);
    }

    const addMarkers = () => {
        const markersData: MarkerData[] = [];
        equipments.forEach(eq => {
            const marker = new ExtendedMarker(eq.position, { icon: rippleIcon(eq) }).addTo(mapRef.current!)
            markersData.push({ id: eq.id, marker: marker })
        })
        setMarkers(markersData);
    }

    const zoomToGeofence = (id) => {
        let geofence = geofences.find((fence) => fence.layer.id === id);
        mapRef.current?.fitBounds(geofence.layer.getBounds());
    }

    const toggle = () => setModal(!modal);

    const handleAddGeofence = () => {
        setNewGeofenceName("");
        toggle();
    };

    const handleSaveGeofence = () => {
        let fenceIndex = geofences.findIndex((fence) => fence.layer.id === selectedFence.layer.id);
        geofences[fenceIndex].name = newGeofenceName;
        setGeofences([...geofences]);
        toggle();
        setNewGeofenceName("");
    };

    const handleCancel = () => {
        toggle();
        setNewGeofenceName("");
    };

    const handleDeleteGeofence = (event, id) => {
        event.stopPropagation();
        if (mapRef.current) {
            const deletedGeofence = geofences.find(geofence => geofence.layer.id == id);
            if (deletedGeofence) {
                mapRef.current.removeLayer(deletedGeofence.layer!);
            }
        }

        setGeofences([...geofences.filter(geofence => geofence.layer.id !== id)]);
    };

    const createGeofence = () => {
        // if (type === 'circle') {
        //     geojson = (layer as Leaflet.Circle<any>).toGeoJSON();
        //     geojson.properties.radius = (layer as Leaflet.Circle<any>).getRadius();
        // } else {
        //     geojson = (layer as Leaflet.Circle<any>).toGeoJSON();
        // }
    }

    return (
        <React.Fragment>
            <div className="page-content">
                <Container fluid>
                    <Row>
                        <Col md="8">
                            <Card>
                                <CardBody>
                                    <div id="map" style={{ height: '80vh', width: '100%' }}></div>
                                </CardBody>
                            </Card>
                        </Col>
                        <Col md="4">
                            <Card>
                                <CardBody>
                                    <Row className="mb-3 d-flex justify-content-between">
                                        <Col xs="6">
                                            <h4>Geofences</h4>
                                        </Col>
                                        {/* <Col xs="6" className="d-flex justify-content-end">
                                            <Button color="primary" onClick={handleAddGeofence}>Add</Button>
                                        </Col> */}
                                    </Row>
                                    <ListGroup>
                                        {geofences.map(geofence => {
                                            if (geofence.name) {
                                                return (
                                                    <ListGroupItem key={geofence.layer.id} onClick={() => zoomToGeofence(geofence.layer.id)} className="d-flex justify-content-between align-items-center" style={{ 'cursor': 'pointer' }}>
                                                        {geofence.name}
                                                        <Button color="danger" size="sm" onClick={(event) => handleDeleteGeofence(event, geofence.layer.id)}>Delete</Button>
                                                    </ListGroupItem>
                                                )
                                            }
                                        })}
                                    </ListGroup>
                                </CardBody>
                            </Card>
                        </Col>
                    </Row>
                </Container>
            </div>

            <Modal isOpen={modal} toggle={toggle}>
                <ModalHeader toggle={toggle}>Add Geofence</ModalHeader>
                <ModalBody>
                    <Input
                        type="text"
                        value={newGeofenceName}
                        onChange={(e) => setNewGeofenceName(e.target.value)}
                        placeholder="Enter geofence name"
                    />
                </ModalBody>
                <ModalFooter>
                    <Button color="secondary" onClick={handleCancel}>Cancel</Button>
                    <Button color="primary" onClick={handleSaveGeofence}>Save</Button>
                </ModalFooter>
            </Modal>
        </React.Fragment>
    );
}

export default MapGeofence;
